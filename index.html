<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>Message</title>
  <style>
    :root {
      --bg: #f9f9f9;
      --text: #111111;
      --muted: #666666;
      --card: #ffffff;
      --accent: #000000;
      --accent-2: #444444;
      --danger: #cc0000;
      --divider: #dddddd;
      --shadow: 0 6px 18px rgba(0,0,0,0.1);
      --radius: 14px;
    }
    [data-theme="dark"] {
      --bg: #111111;
      --text: #f9f9f9;
      --muted: #aaaaaa;
      --card: #1c1c1c;
      --accent: #ffffff;
      --accent-2: #888888;
      --danger: #ff5555;
      --divider: #333333;
      --shadow: 0 6px 18px rgba(0,0,0,0.5);
    }
    *{margin:0;padding:0;box-sizing:border-box}
    body{
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto;
      background: var(--bg);
      color: var(--text);
      min-height: 100vh;
      display:flex;
      flex-direction:column;
      justify-content:center;
      align-items:center;
      padding:16px;
      transition: background 0.3s, color 0.3s;
    }
    #countdownText {
      font-weight:700;
      font-size:1.1rem;
      text-align:center;
      margin-bottom:10px;
      color:var(--danger);
    }
    #progressBarWrapper {
      width:80%;
      max-width:400px;
      height:10px;
      background:var(--divider);
      border-radius:6px;
      overflow:hidden;
      margin-bottom:14px;
    }
    #progressBar {
      height:100%;
      background:linear-gradient(90deg,var(--accent),var(--accent-2));
      width:100%;
      transition:width 1s linear;
    }
    #messageBox {
      background:var(--card);
      border:1px solid var(--divider);
      border-radius:var(--radius);
      box-shadow:var(--shadow);
      padding:16px;
      width:100%;
      max-width:400px;
      min-height:160px;
      display:flex;
      flex-direction:column;
      justify-content:center;
      text-align:center;
      transition: background 0.3s, border 0.3s, box-shadow 0.3s;
    }
    #message {
      font-size:1rem;
      line-height:1.5;
      margin-bottom:10px;
      word-wrap:break-word;
      overflow-y:auto;
      flex:1;
    }
    #status {
      font-weight:700;
      font-size:1rem;
      margin-top:8px;
    }
    .after-text {
      display:block;
      margin-top:6px;
      font-size:.9rem;
      color:var(--muted);
    }
    footer {
      margin-top:20px;
      font-size:.8rem;
      color:var(--muted);
      text-align:center;
    }
    .fade-out {
      animation: fadeOut 1s forwards;
    }
    @keyframes fadeOut {
      from {opacity:1;}
      to {opacity:0;}
    }
    .theme-toggle {
      position: fixed;
      top: 10px;
      right: 10px;
      padding: 6px 12px;
      font-size: 0.9rem;
      border-radius: 6px;
      border: none;
      background: var(--accent);
      color: var(--card);
      cursor: pointer;
    }
  </style>
</head>
<body>
  <button class="theme-toggle" id="themeToggle">🌙</button>

  <div id="countdownText">This message will self-destruct</div>
  <div id="progressBarWrapper"><div id="progressBar"></div></div>

  <div id="messageBox">
    <p id="message">Loading...</p>
    <p id="status"></p>
  </div>

  <footer>Daily reset at 3PM</footer>

  <script>
    const FALLBACK_QUOTES = [
      "Believe in yourself.",
      "Stay hungry, stay foolish.",
      "Great things never come from comfort zones.",
      "Dream it. Wish it. Do it.",
      "Push yourself, because no one else will do it for you.",
      "Success doesn’t just find you. You have to go out and get it.",
      "Don’t stop when you’re tired. Stop when you’re done.",
      "Do something today that your future self will thank you for.",
      "Little things make big days.",
      "It’s going to be hard, but hard does not mean impossible.",
      "Don’t wait for opportunity. Create it.",
      "Sometimes we’re tested not to show our weaknesses, but to discover our strengths.",
      "The harder you work for something, the greater you’ll feel when you achieve it.",
      "Dream bigger. Do bigger.",
      "Don’t watch the clock; do what it does. Keep going.",
      "Great things take time.",
      "Action is the foundational key to all success.",
      "If you can dream it, you can do it.",
      "Your limitation—it’s only your imagination.",
      "The way to get started is to quit talking and begin doing."
    ];

    const progressBar = document.getElementById("progressBar");
    const messageEl = document.getElementById("message");
    const statusEl = document.getElementById("status");
    const countdownText = document.getElementById("countdownText");

    async function fetchQuote() {
      try {
        const res = await fetch("https://api.quotable.io/random");
        if (!res.ok) throw new Error();
        const data = await res.json();
        return `${data.content} — ${data.author}`;
      } catch {
        return FALLBACK_QUOTES[Math.floor(Math.random() * FALLBACK_QUOTES.length)];
      }
    }

    function getNextResetTime() {
      const now = new Date();
      const reset = new Date();
      reset.setHours(15, 0, 0, 0); // 3PM today
      if (now > reset) {
        reset.setDate(reset.getDate() + 1);
      }
      return reset;
    }

    async function loadMessage() {
      const stored = JSON.parse(localStorage.getItem("dailyMessage") || "{}");
      const now = new Date();
      const resetTime = getNextResetTime();

      if (!stored.message || !stored.resetTime || now >= new Date(stored.resetTime)) {
        const quote = await fetchQuote();
        localStorage.setItem("dailyMessage", JSON.stringify({ 
          message: quote, 
          resetTime: resetTime 
        }));
        return quote;
      }
      return stored.message;
    }

    function startSelfDestruct(msg) {
      let duration = Math.max(10, Math.ceil(msg.length / 12));
      let remaining = duration;
      progressBar.style.width = "100%";
      const timer = setInterval(() => {
        remaining--;
        progressBar.style.width = (remaining / duration) * 100 + "%";
        if (remaining <= 0) {
          clearInterval(timer);
          destroyMessage();
        }
      }, 1000);
    }

    function destroyMessage() {
      messageEl.classList.add("fade-out");
      setTimeout(() => {
        messageEl.textContent = "";
        statusEl.textContent = "";
        const after = document.createElement("span");
        after.className = "after-text";
        after.textContent = "Message destroyed";
        statusEl.appendChild(after);
      }, 1000);
    }

    
    const themeToggle = document.getElementById("themeToggle");
    themeToggle.addEventListener("click", () => {
      const current = document.body.getAttribute("data-theme");
      if (current === "dark") {
        document.body.removeAttribute("data-theme");
        themeToggle.textContent = "🌙";
      } else {
        document.body.setAttribute("data-theme", "dark");
        themeToggle.textContent = "☀️";
      }
    });

    
    (async () => {
      const msg = await loadMessage();
      messageEl.textContent = msg;
      startSelfDestruct(msg);

     
      setInterval(async () => {
        const stored = JSON.parse(localStorage.getItem("dailyMessage") || "{}");
        const now = new Date();
        if (stored.resetTime && now >= new Date(stored.resetTime)) {
          localStorage.removeItem("dailyMessage");
          const newMsg = await loadMessage();
          messageEl.textContent = newMsg;
          statusEl.textContent = "";
          messageEl.classList.remove("fade-out");
          startSelfDestruct(newMsg);
        }
      }, 60000);
    })();
  </script>
</body>
</html>